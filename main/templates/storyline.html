{% extends 'base.html' %}
{% load static %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static "custom/jquery.qtip.min.css" %}"/>
{% endblock %}

{% block javascript %}
    <script src="{% static "js/cytoscape.min.js" %}"></script>
    <script src="{% static "js/dagre.min.js" %}"></script>
    <script src="{% static "js/cytoscape-dagre.js" %}"></script>
    <script src="{% static "js/jquery.qtip.min.js" %}"></script>
    <script src="{% static "js/cytoscape-qtip.js" %}"></script>
    <script src="{% static "custom/storyline.js" %}"></script>
{% endblock %}

{% block body %}
    <div id="cy"></div>
    <script>
        $(document).ready(function () {
            $.getJSON("{% static "custom/file.json" %}", function (json) {
                cy.add(json);
                cy.layout({name: "dagre"});
                cy.on('mouseover', 'node', function (event) {
                    var node = event.cyTarget;
                    var link = node.attr('href');
                    $.ajax({
                               url: link
                           }).then(function (content) {
                        var link_content = content;
                        node.qtip({
                                      content: link_content,
                                      position: {
                                          at: 'bottom center'
                                      },
                                      show: {
                                          event: "mouseover",
                                          solo: true,
                                          ready: true
                                      },
                                      hide: {
                                          event: 'mouseout'
                                      },
                                      style: {
                                          classes: 'qtip-bootstrap',
                                          tip: {
                                              width: 16,
                                              height: 8
                                          }
                                      }
                                  }, event);
                    }, function (xhr, status, error) {
                        console.log(error);
                    });
                });
            });
        });
    </script>
{% endblock %}